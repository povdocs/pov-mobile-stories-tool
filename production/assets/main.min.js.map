{"version":3,"sources":["1.assetManager.js","2.device-info.js","3.0.app.js","3.1.story.js","9.main.js"],"names":["createCORSRequest","method","url","xhr","XMLHttpRequest","open","XDomainRequest","AssetManager","this","DEBUG","successCount","errorCount","cache","downloadQueue","inQueue","prototype","queueDownload","path","push","constructor","queue","downloadCallback","length","parentThis","i","obj","type","downloadImage","result","isDone","downloadAudio","downloadVideo","image","Image","console","log","addEventListener","event","progressCount","loaded","total","e","error","src","audio","Audio","Error","responseType","window","URL","webkitURL","createObjectURL","response","send","video","progress","key","hasOwnProperty","Math","round","getAsset","updateProgress","lengthComputable","percentComplete","ua","navigator","userAgent","platform","mobile","browser","version","os","osversion","bit","test","exec","split","replace","join","device","app","storyFile","assetManager","touchX","touchY","currentScroll","currentStory","assets","allAssets","data","stories","startedTF","loadedTF","downloadTF","title","document","width","$","height","swipeThreshold","cacheCover","casheContent","touchThreshold","transitionSpeed","introLogo","introTitle","defaultIntroImg","iosLessThen10","iosChromeLessThen54","init","readFile","downloadAssets","addClass","toLowerCase","standalone","story","howTo","on","animate","top","hide","callback","getJSON","d","l","cover","css","background-image","addAssetManager","content","index","indexOf","start","progressState","setInterval","clearInterval","create","time","eventListener","play","getCurrent","hasClass","preventDefault","toggleFullScreen","preload","contentVideo","next","bind","currentSrc","controls","loop","volume","tagName","attr","parent","keyCode","previous","show","getScroll","scroll","stopMedia","media","pause","currentTime","playMedia","load","docEl","documentElement","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","eventListeners","main","getElementById","section","createElement","setAttribute","close","appendChild","message","parseInt","innerHTML","povLogo","playButton","get","id","stop","scrollLeft","find","each","originalEvent","touches","clientX","clientY","mainScroll","x","y","abs","scrollTop","changedTouches","swipe","removeClass","removeAttr","ready"],"mappings":"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","file":"main.min.js","sourcesContent":["/*!\nSunil Patel, Developer, POV Digital | github.com/povdocs/pov-mobile-storytelling\nCopyright (C) 2016 POV | American Documentary Inc.\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\n/**\n * Using CORS\n */\nfunction createCORSRequest(method, url) {\n  var xhr = new XMLHttpRequest();\n  if (\"withCredentials\" in xhr) {\n    // Check if the XMLHttpRequest object has a \"withCredentials\" property.\n    // \"withCredentials\" only exists on XMLHTTPRequest2 objects.\n    xhr.open(method, url, true);\n  }\n  else if (typeof XDomainRequest != \"undefined\") {\n    // Otherwise, check if XDomainRequest.\n    // XDomainRequest only exists in IE, and is IE's way of making CORS requests.\n    xhr = new XDomainRequest();\n    xhr.open(method, url);\n  }\n  else {\n    // Otherwise, CORS is not supported by the browser.\n    xhr = null;\n  }\n  return xhr;\n}\n\nfunction AssetManager() {\n  this.DEBUG = false;\n  this.successCount = 0;\n  this.errorCount = 0;\n  this.cache = {};\n  this.downloadQueue = [];\n  this.inQueue = {};\n}\n\nAssetManager.prototype.queueDownload = function(path) {\n  this.downloadQueue.push(path);\n};\n\nAssetManager.prototype.constructor = function(queue, downloadCallback) {\n  if(typeof queue!==\"undefined\") this.downloadQueue = queue;\n  if (this.downloadQueue.length === 0 && typeof downloadCallback!==\"undefined\") downloadCallback();\n  var parentThis = this;\n  for (var i = 0; i < this.downloadQueue.length; i++) {\n    var obj = this.downloadQueue[i];\n    // skip if the asset is already downloaded\n    // if(this.getAsset(obj.path)!=\"undefined\") continue;\n\n    if(obj.type=='image'){\n      this.downloadImage(obj.path, function(path, result){\n        parentThis.cache[path] = result;\n        if(parentThis.isDone()) downloadCallback();\n      });\n    }\n    else if(obj.type=='audio'){\n      this.downloadAudio(obj.path, function(path, result){\n        parentThis.cache[path] = result;\n        if(parentThis.isDone()) downloadCallback();\n      });\n    }\n    else if(obj.type=='video'){\n      this.downloadVideo(obj.path, function(path, result){\n        parentThis.cache[path] = result;\n        if(parentThis.isDone()) downloadCallback();\n      });\n    }\n    else continue;\n  }\n};\n\nAssetManager.prototype.downloadImage = function(path, downloadCallback){\n  var image      = new Image();\n  var parentThis = this;\n  if(parentThis.DEBUG) console.log(\"IMAGE DOWNLOADING: \", path);\n\n  image.addEventListener(\"progress\", function (event) {\n    parentThis.progressCount(path, event.loaded, event.total);\n  });\n  image.addEventListener(\"load\", function() {\n    parentThis.successCount += 1;\n    if(parentThis.DEBUG) console.log(\"IMAGE DOWNLOADED: \", path);\n    downloadCallback(path, image);\n  }, false);\n  image.addEventListener(\"error\", function(e) {\n    parentThis.errorCount += 1;\n    if(parentThis.DEBUG) console.error(\"ERROR DOWNLOADING IMAGE: \", path, e);\n  }, false);\n  image.src = path;\n};\n\nAssetManager.prototype.downloadAudio = function(path, downloadCallback){\n  var audio      = new Audio();\n  var parentThis = this;\n  var xhr        = createCORSRequest('GET', path);\n  \n  if (!xhr) throw new Error('CORS not supported');\n  if(parentThis.DEBUG) console.log(\"AUDIO DOWNLOADING: \", path);\n\n  xhr.responseType = 'blob';\n\n  xhr.addEventListener(\"progress\", function (event) {\n    parentThis.progressCount(path, event.loaded, event.total);\n  });\n  xhr.addEventListener(\"load\", function() {\n    if(parentThis.DEBUG) console.log(\"AUDIO DOWNLOADED: \", path);\n    parentThis.successCount += 1;\n    window.URL = window.URL || window.webkitURL;\n    audio = window.URL.createObjectURL(this.response);\n    downloadCallback(path, audio);\n  }, false);\n  xhr.addEventListener(\"error\", function(e) {\n    parentThis.errorCount += 1;\n    if(parentThis.DEBUG) console.error(\"ERROR DOWNLOADING AUDIO: \", path, e);\n  }, false);\n  xhr.send();\n};\n\nAssetManager.prototype.downloadVideo = function(path, downloadCallback){\n  var video      = null;\n  var parentThis = this;\n  var xhr        = createCORSRequest('GET', path);\n  if (!xhr) throw new Error('CORS not supported');\n  if(parentThis.DEBUG) console.log(\"VIDEO DOWNLOADING: \", path);\n\n\txhr.responseType = 'blob';\n\n  xhr.addEventListener(\"progress\", function (event) {\n    parentThis.progressCount(path, event.loaded, event.total);\n  });\n\txhr.addEventListener(\"load\", function() {\n    if(parentThis.DEBUG) console.log(\"VIDEO DOWNLOADED: \", path);\n    parentThis.successCount += 1;\n    window.URL = window.URL || window.webkitURL;\n\t\tvideo = window.URL.createObjectURL(this.response);\n    downloadCallback(path, video);\n\t}, false);\n  xhr.addEventListener(\"error\", function(e) {\n    parentThis.errorCount += 1;\n    if(parentThis.DEBUG) console.error(\"ERROR DOWNLOADING VIDEO: \", path, e);\n  }, false);\n\txhr.send();\n};\n\nAssetManager.prototype.isDone = function() {\n  return (this.progress()<100) ? false : true;\n};\n\nAssetManager.prototype.progress = function() {\n  var progress = 0;\n  var total    = 0;\n\n  for (var key in this.inQueue){\n    if(this.inQueue.hasOwnProperty(key)){\n      progress += this.inQueue[key].progress;\n      total    += this.inQueue[key].total;\n    }\n  }\n\n  return Math.round((progress / total) * 100);\n};\n\nAssetManager.prototype.getAsset = function(path) {\n  if(!this.cache.hasOwnProperty(path)) return path;\n  else return this.cache[path];\n};\n\nAssetManager.prototype.updateProgress = function(path, event) {\n  if (event.lengthComputable) {\n    var percentComplete = event.loaded / event.total;\n    if(parentThis.DEBUG) console.log(path, percentComplete);\n  }\n};\n\nAssetManager.prototype.progressCount = function(path, loaded, total){\n  this.inQueue[path] = {progress: event.loaded, total: event.total};\n};\n","/*!\nSunil Patel, Developer, POV Digital | github.com/povdocs/pov-mobile-storytelling\nCopyright (C) 2016 POV | American Documentary Inc.\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\nvar\n  ua       = window.navigator.userAgent,\n  platform = window.navigator.platform,\n  mobile   = 0,\n  browser,\n  version,\n  os,\n  osversion,\n  bit\n;\n\n// IE\nif(/MSIE/.test(ua)){\n  browser = 'Internet Explorer';\n  version = /MSIE \\d+[.]\\d+/.exec(ua)[0].split(' ')[1];\n  if(/IEMobile/.test(ua)) mobile = 1;\n}\n// iOS chrome\nelse if(/CriOS/.test(ua)){\n  browser  = 'Chrome';\n  version  = /CriOS\\/[\\d\\.]+/.exec(ua)[0].split('/')[1];\n  os       = 'iOS';\n  mobile   = 1;\n\n  if((/iPhone/.test(ua))) platform = 'iPhone';\n  if((/iPad/.test(ua)))   platform = 'iPad';\n  if((/iPod/.test(ua)))   platform = 'iPod';\n}\n// Chrome\nelse if(/Chrome/.test(ua)){\n  browser = 'Chrome';\n  version = /Chrome\\/[\\d\\.]+/.exec(ua)[0].split('/')[1];\n\n  // Check if chrome is Chrome OS\n  if(/CrOS/.test(ua)) platform = 'CrOS';\n}\n// Firefox\nelse if(/Firefox/.test(ua)){\n  browser = 'Firefox';\n  version = /Firefox\\/[\\.\\d]+/.exec(ua)[0].split('/')[1];\n  // check for mobile\n  if(/Fennec/.test(ua)) mobile = 1;\n}\n// Opera\nelse if(/Opera/.test(ua)){\n  browser = 'Opera';\n  if (/mini/.test(ua) || /Mobile/.test(ua)) mobile = 1;\n}\n// Android\nelse if(/Android/.test(ua)){\n  browser = 'Android Webkit Browser';\n  os      = /Android\\s[\\.\\d]+/.exec(ua)[0];\n  mobile  = 1;\n}\n// Safari\nelse if(/Safari/.test(ua)){\n  browser = 'Safari';\n  version = /Version\\/[\\.\\d]+/.exec(ua)[0].split('/')[1];\n\n  if((/iPhone/.test(ua))) platform = 'iPhone';\n  if((/iPad/.test(ua)))   platform = 'iPad';\n  if((/iPod/.test(ua)))   platform = 'iPod';\n} \n//\nif(!version){\n  version = /Version\\/[\\.\\d]+/.exec(ua);\n  version = (version) ? version[0].split('/')[1] : /Opera\\/[\\.\\d]+/.exec(ua)[0].split('/')[1];\n}\n//\nif(platform === 'iPhone' || platform === 'iPad' || platform === 'iPod'){\n  os        = 'iOS';\n  mobile    = 1;\n  osversion = /OS\\s[\\_\\d]+/.exec(ua)[0].split(' ')[1].replace(/_/g, '.');\n}\n//\nelse if(platform==='MacIntel' || platform==='MacPPC'){\n  os        = 'Mac OS X';\n  osversion = /10[\\.\\_\\d]+/.exec(ua);\n  if(osversion){\n    osversion = osversion[0];\n    if(/[\\_]/.test(osversion)){\n      osversion = osversion.split('_').join('.');\n    }\n  }\n}\n//\nelse if(platform==='CrOS'){\n  os  = 'ChromeOS';\n}\n//\nelse if(platform==='Win32' || platform==='Win64'){\n  os  = 'Windows';\n  bit = platform.replace(/[^0-9]+/,'');\n}\n//\nelse if(!os && /Android/.test(ua)){\n  os  = 'Android';\n}\n//\nelse if(!os && /Linux/.test(platform)){\n  os  = 'Linux';\n}\n//\nelse if(!os && /Windows/.test(ua)){\n  os  = 'Windows';\n} \n\n// setup device info\nwindow.device = {\n  mobile:    mobile,\n  browser:   browser,\n  version:   version,\n  os:        os,\n  osversion: osversion,\n  bit:       bit,\n  platform: platform\n};\n","/*!\nSunil Patel, Developer, POV Digital | github.com/povdocs/pov-mobile-storytelling\nCopyright (C) 2016 POV | American Documentary Inc.\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\nvar app = {\n  DEBUG:           false,\n  storyFile:       'assets/story.json',\n  assetManager:    new AssetManager(),\n  touchX:          null,\n  touchY:          null,\n  currentScroll:   0,\n  currentStory:    0,\n  assets:          [],\n  allAssets:       [],\n  data:            [],\n  stories:         [],\n  startedTF:       false,\n  loadedTF:        false,\n  downloadTF:      false,\n  title:           document.title,\n  width:           $('main').width(),\n  height:          $('main').height(),\n  swipeThreshold:  6,\n  cacheCover:      true,\n  casheContent:    false,\n  touchThreshold:  40,\n  transitionSpeed: 600,\n  introLogo:       \"assets/media/pov-logo-web-transparent-bg-white-text.svg\",\n  introTitle:      \"Mobile Story Telling\",\n  defaultIntroImg: \"assets/media/default-intro-cover.jpg\",\n  iosLessThen10:       \"For better experience please view this on iOS 10.\",\n  iosChromeLessThen54: \"For better experience please view this on Safari in iOS 10.\",\n\n  init: function () {\n    app.assetManager.DEBUG = app.DEBUG;\n    app.readFile(app.downloadAssets);\n\n    if(window.device){\n      var os = window.device.os.replace(/\\s/g, \"\");\n      $('body').addClass(os.toLowerCase());\n      $('body').addClass(window.device.browser.toLowerCase());\n      $('body').addClass(window.device.platform.toLowerCase());\n    }\n\n    if((\"standalone\" in window.navigator) && window.navigator.standalone){\n      $('body').addClass('fullscreen');\n    }\n\n    app.story.howTo();\n\n    $('#how-to-close').on('click', function(){\n      $('#how-to').animate({\n        top: '-110%'\n      }, app.transitionSpeed, function(){\n        $(this).hide();\n      });\n    });\n  },\n\n  readFile: function(callback){\n    $.getJSON(app.storyFile, function(data){\n      app.data = data;\n      for (var i = 0, d = null, l = data.length; i < l; i++) {\n        d = data[i];\n        if(i===0 && d.cover){\n          if(!d.cover.image) d.cover.image = app.defaultIntroImg;\n          $('#launcher').css({'background-image': \"url('\"+d.cover.image+\"')\"});\n        }\n        if(d.cover && app.cacheCover){\n          if(d.cover.image) app.addAssetManager('image', d.cover.image);\n          if(d.cover.audio) app.addAssetManager('audio', d.cover.audio);\n          if(d.cover.video) app.addAssetManager('video', d.cover.video);\n        }\n        if(d.content && app.casheContent){\n          if(d.content.type=='video') app.addAssetManager('video', d.content.src);\n        }\n        if(i==l-1) callback();\n      }\n    });\n  },\n\n  addAssetManager: function (type, path) {\n    var index = app.assets.indexOf(path);\n    if(index<0){\n      app.allAssets.push({'type': type, 'path': path});\n      app.assets.push(path);\n      return app.allAssets.length - 1;\n    }\n    return index;\n  },\n\n  downloadAssets: function (){\n\n    app.assetManager.constructor(app.allAssets, function(){\n      for (var i = 0, d = null, l = app.data.length; i < l; i++) {\n        d = app.data[i];\n        if(d.cover && app.cacheCover){\n          if(d.cover.audio) d.cover.audio = app.assetManager.getAsset(d.cover.audio);\n          if(d.cover.video) d.cover.video = app.assetManager.getAsset(d.cover.video);\n        }\n        if(d.content && app.casheContent){\n          if(d.content.type=='video') d.content.src = app.assetManager.getAsset(d.content.src);\n        }\n      }\n      app.start();\n    });\n\n\n    // update progress bar on screen\n    var progressState = setInterval(function() {\n      var progress = app.assetManager.progress();\n      if (progress<100) {\n        $('#progress-bar').css({'width': progress+'%'});\n        document.title = progress+'% | '+app.title;\n      }else{\n        clearInterval(progressState);\n        app.downloadTF = true;\n        document.title = app.title;\n      }\n    }, 1000);\n  },\n\n  start: function () {\n    if(!app.loadedTF){\n      for (var i = 0, l = app.data.length; i < l; i++) {\n        app.story.create(i, app.data[i]);\n        if(i==l-1) app.loadedTF = true;\n      }\n    }\n    var time = setInterval(function(){\n      if(app.loadedTF && app.downloadTF){\n        $('#launcher').hide();\n        app.eventListener();\n        app.story.init();\n        app.story.play(app.story.getCurrent());\n        clearInterval(time);\n      }\n    }, 1000);\n  },\n\n  eventListener: function () {\n\n    $(document).on('touchmove', function(event){\n      var story = app.story.getCurrent();\n      if(!$(story.content).hasClass('html')) event.preventDefault();\n    });\n\n    // start story story\n    $('#intro-play').on('click', function () {\n      if(!app.startedTF){\n        app.toggleFullScreen();\n        app.startedTF = true;\n        for (var i = 0, story = null, l = app.stories.length; i < l; i++) {\n          story = app.stories[i];\n          if(story.video) app.preload(story.video);\n          if(story.audio) app.preload(story.audio);\n          if(story.contentVideo) app.preload(story.contentVideo);\n        }\n      }\n      app.story.next();\n    });\n\n    $('video,audio').bind('abort', function(e){\n      if(app.DEBUG) console.log(this.currentSrc, 'abort function fired');\n      this.controls = true;\n    }).bind('emptied', function(e){\n      if(app.DEBUG) console.log(this.currentSrc, 'emptied function fired');\n      this.controls = true;\n    }).bind('error', function(e){\n      if(app.DEBUG) console.log(this.currentSrc, 'error function fired');\n      this.controls = true;\n    }).bind('stalled', function(e){\n      if(app.DEBUG) console.log(this.currentSrc, 'stalled function fired');\n      this.controls = true;\n    }).bind('ended', function(e){\n      if(app.DEBUG) console.log(this.currentSrc, 'ended function fired');\n      if(!this.loop) this.controls = true;\n    }).bind('pause', function(e){\n      if(app.DEBUG) console.log(this.currentSrc, 'pause function fired');\n      this.volume      = 0;\n    }).bind('play', function(e){\n      if(app.DEBUG) console.log(this.currentSrc, 'play function fired');\n      this.volume      = 1;\n      if(this.tagName && this.tagName===\"VIDEO\" && $('body').hasClass('iphone') && $('body').hasClass('ios')){\n        $(this).attr('style', 'height: '+$('main').height()+'px');\n      }\n    }).bind('playing', function(e){\n      if(app.DEBUG) console.log(this.currentSrc, 'playing function fired');\n      if($(this).parent().hasClass('story-cover')) this.controls = false;\n    });\n\n    // navigate using keyboard\n    $(document).on('keydown', function(event){\n      // left key\n      if(event.keyCode==37) app.story.previous();\n      // up key\n      else if(event.keyCode==38) app.story.cover.show(true);\n      // right key\n      else if(event.keyCode==39) app.story.next();\n      // down key\n      else if(event.keyCode==40) app.story.content.show();\n    });\n  },\n\n  getScroll: function () {\n    var scroll = app.currentScroll;\n    var width  = $('main').width();\n    scroll = (scroll<0) ? 0 : scroll;\n    if((scroll % width) !== 0) scroll = scroll - (scroll % width);\n    return scroll;\n  },\n\n  stopMedia: function (media) {\n    if(!media) return false;\n    media.pause();\n    media.currentTime = 0;\n  },\n\n  playMedia: function (media) {\n    if(!media) return false;\n    media.play();\n  },\n\n  preload: function (media) {\n    if(!media) return false;\n    media.load();\n    media.play();\n    media.pause();\n    media.currentTime = 0;\n  },\n\n  toggleFullScreen: function () {\n    var docEl = document.documentElement;\n    if(!document.fullscreenElement && !document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) {\n           if(docEl.requestFullscreen)       { docEl.requestFullscreen(); }\n      else if(docEl.msRequestFullscreen)     { docEl.msRequestFullscreen(); }\n      else if(docEl.mozRequestFullScreen)    { docEl.mozRequestFullScreen(); }\n      else if(docEl.webkitRequestFullscreen) { docEl.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT); }\n      else{}\n    } else {\n           if (document.exitFullscreen)      { document.exitFullscreen(); }\n      else if(document.msExitFullscreen)     { document.msExitFullscreen(); }\n      else if(document.mozCancelFullScreen)  { document.mozCancelFullScreen(); }\n      else if(document.webkitExitFullscreen) { document.webkitExitFullscreen(); }\n      else{}\n    }\n  },\n};\n","/*!\nSunil Patel, Developer, POV Digital | github.com/povdocs/pov-mobile-storytelling\nCopyright (C) 2016 POV | American Documentary Inc.\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\napp.story = {\n\n  init: function () {\n    app.story.cover.eventListeners();\n    app.story.content.eventListeners();\n  },\n\n  howTo: function(){\n    var main = document.getElementById('main');\n    var section = document.createElement('div');\n    section.setAttribute('class', 'how-to');\n    section.setAttribute('id', 'how-to');\n\n    var close = document.createElement('div');\n    close.setAttribute('id', 'how-to-close');\n    close.setAttribute('class', 'how-to-close');\n\n\n    var howTo = document.createElement('img');\n    howTo.setAttribute('class', 'how-to-image');\n    howTo.setAttribute('src', 'assets/media/mobile-storytelling-how-to.svg');\n    howTo.setAttribute('alt', \"Mobile Storytelling How To\");\n    howTo.setAttribute('width', \"200\");\n    howTo.setAttribute('height', \"auto\");\n\n\n    section.appendChild(close);\n\n    if('device' in window && window.device){\n      var message = document.createElement('div');\n      message.setAttribute('class', 'how-to-message');\n      if(window.device.os.toLowerCase()=='ios'){\n        if(parseInt(window.device.osversion)<10){\n          message.innerHTML = app.iosLessThen10;\n          section.appendChild(message);\n        }\n        else if(window.device.browser.toLowerCase()=='chrome' && parseInt(window.device.version)<54){\n          message.innerHTML = app.iosChromeLessThen54;\n          section.appendChild(message);\n        }\n      }\n    }\n\n    section.appendChild(howTo);\n    main.appendChild(section);\n  },\n\n  create: function (i, story) {\n    var main = document.getElementById('main');\n    var section = '';\n    var obj = {\n      video: null,\n      audio: null,\n      image: null,\n      cover: null,\n      content: null,\n      contentVideo: null\n    };\n    section = document.createElement('section');\n    section.setAttribute('class', (i===0) ? 'intro' : 'story');\n    section.setAttribute('id', 'story'+i);\n\n    if(i===0){\n\n      if(story.cover.image){\n        section.setAttribute('style', \"background-image: url('\"+story.cover.image+\"')\");\n      }else{\n        var povLogo = document.createElement('img');\n        povLogo.setAttribute('src', app.introLogo);\n        povLogo.setAttribute('alt', 'POV Logo');\n        povLogo.setAttribute('width', '200');\n        povLogo.setAttribute('height', 'auto');\n        povLogo.setAttribute('class', 'intro-pov-logo');\n\n        var title = document.createElement('h1');\n        title.setAttribute('class', 'intro-title');\n        title.innerHTML = app.introTitle;\n\n        section.appendChild(povLogo);\n        section.appendChild(title);\n      }\n      var playButton = document.createElement('button');\n      playButton.setAttribute('type', 'button');\n      playButton.setAttribute('id', 'intro-play');\n      playButton.setAttribute('class', 'intro-play-btn');\n      playButton.innerHTML = \"Start\";\n\n      section.appendChild(playButton);\n    }else{\n\n      // cover\n      var cover = document.createElement('div');\n      cover.setAttribute('class', 'story-cover');\n      // add cover content\n      if(story.cover.video){\n        var video = document.createElement('video');\n        video.setAttribute('playsinline', true);\n        video.setAttribute('webkit-playsinline', true);\n        video.setAttribute('src', story.cover.video);\n        video.setAttribute('preload', 'metadata');\n        video.setAttribute('loop', true);\n        video.setAttribute('controls', false);\n        video.setAttribute('class', 'story-cover-video');\n        cover.appendChild(video);\n        obj.video = video;\n      }else{\n        if(story.cover.image){\n          var image = document.createElement('img');\n          image.setAttribute('src', story.cover.image);\n          image.setAttribute('alt', '');\n          image.setAttribute('width', '100%');\n          image.setAttribute('height', '');\n          image.setAttribute('class', 'story-cover-image');\n          cover.appendChild(image);\n          obj.image = image;\n        }\n        if(story.cover.audio){\n          var audio = document.createElement('audio');\n          audio.setAttribute('src', story.cover.audio);\n          audio.setAttribute('preload', 'metadata');\n          audio.setAttribute('loop', true);\n          audio.setAttribute('controls', false);\n          audio.setAttribute('class', 'story-cover-audio');\n          cover.appendChild(audio);\n          obj.audio = audio;\n        }\n      }\n      section.appendChild(cover);\n      obj.cover = cover;\n\n      // content\n      if(i>0 && story.content.type!=='' && story.content.src!==''){\n        var content = document.createElement('article');\n        content.setAttribute('class', 'story-content '+story.content.type);\n        // add html content to story\n        if(story.content.type=='html'){\n          content.innerHTML = story.content.src;\n        }\n        if(story.content.type=='video'){\n          var contentVideo = document.createElement('video');\n          contentVideo.setAttribute('playsinline', true);\n          contentVideo.setAttribute('webkit-playsinline', true);\n          contentVideo.setAttribute('src', story.content.src);\n          contentVideo.setAttribute('preload', 'metadata');\n          contentVideo.setAttribute('loop', false);\n          contentVideo.setAttribute('controls', true);\n          contentVideo.setAttribute('class', 'story-content-video');\n          content.appendChild(contentVideo);\n          obj.contentVideo = contentVideo;\n        }\n        section.appendChild(content);\n        if(story.content.type){\n          $(section).addClass('content-more');\n          $(section).addClass(story.content.type);\n        }\n        obj.content = content;\n      }\n    }\n    main.appendChild(section);\n    app.stories.push(obj);\n  },\n\n  getCurrent: function () {\n    if(app.currentStory<0) app.currentStory = 0;\n    return app.story.get(app.currentStory);\n  },\n\n  get: function (id) {\n    // change the index and return the story object\n    if(id<0 || id>app.stories.length) return null;\n    return app.stories[id];\n  },\n\n  next: function () {\n    var width   = app.width;\n    var section = $('section.story').length;\n    var scroll  = app.getScroll() + width;\n    app.story.cover.show(false);\n    if(scroll<=(width*section)){\n      $('main').stop().animate({\n        scrollLeft: scroll\n      }, app.transitionSpeed, function(){\n        var id = (scroll/width);\n        app.currentScroll = scroll;\n        app.currentStory   = id;\n        app.story.stop(app.story.get(id-1));\n        app.story.play(app.story.get(id));\n      });\n    }\n  },\n\n  previous: function () {\n    var width  = app.width;\n    var scroll = app.getScroll() - width;\n    app.story.cover.show(false);\n    if(scroll>=0){\n      $('main').stop().animate({\n        scrollLeft: scroll\n      }, app.transitionSpeed, function(){\n        var id = (scroll/width);\n        app.currentScroll = scroll;\n        app.currentStory   = id;\n        app.story.stop(app.story.get(id+1));\n        app.story.play(app.story.get(id));\n      });\n    }\n  },\n\n  play: function (story) {\n    if(!story) return false;\n    if(story.video) app.playMedia(story.video);\n    else if(story.audio) app.playMedia(story.audio);\n  },\n\n  stop: function (story) {\n    if(!story) return false;\n    if(story.video) app.stopMedia(story.video);\n    else if(story.audio) app.stopMedia(story.audio);\n  },\n\n  content: {\n    show: function () {\n      var story = app.story.getCurrent();\n      if(!story.content || $(story.cover).hasClass('over')) return false;\n      $(story.cover).animate({\n        top: '-110%'\n      }, app.transitionSpeed, function(){\n        $(this).addClass('over');\n      });\n      app.story.stop(story);\n      if(story.contentVideo) app.playMedia(story.contentVideo);\n    },\n\n    stop: function (story) {\n      if(!story) story = app.story.getCurrent();\n      if(!story.content) return false;\n      // stop all the video and audio in the content\n      $(story.content).find('video,audio').each(function(){\n        app.stopMedia(this);\n      });\n    },\n\n    eventListeners: function () {\n      $('.story-content').on('touchstart', function(event){\n        if(!app.startedTF) return;\n        app.touchX = event.originalEvent.touches[0].clientX;\n        app.touchY = event.originalEvent.touches[0].clientY;\n        app.mainScroll = app.getScroll();\n      })\n      .on('touchmove', function(event){\n        if(!app.touchX && !app.touchY) return;\n        var x = app.touchX - event.originalEvent.touches[0].clientX;\n        var y = app.touchY - event.originalEvent.touches[0].clientY;\n        \n        if(Math.abs(x) > Math.abs(y)){\n          // scroll main as user moves from left to right\n          $('main').scrollLeft(app.getScroll() + x);\n        }else{\n          var story = app.story.getCurrent();\n          if(story.content && $(story.cover).hasClass('over') && y<0 && $(story.content).scrollTop()===0){\n            y = ((y + $('main').height())/$('main').height()) * 100;\n            $(story.cover).css({'top': (y * -1)+'%'});\n          }\n        }\n      })\n      .on('touchend', function(event){\n        if(!app.touchX && !app.touchY) return;\n        var x      = app.touchX - event.originalEvent.changedTouches[0].clientX;\n        var y      = app.touchY - event.originalEvent.changedTouches[0].clientY;\n        console.log(x, y, app.touchX, app.touchY, event.originalEvent.changedTouches[0].clientX, event.originalEvent.changedTouches[0].clientY);\n        app.touchX = null;\n        app.touchY = null;\n        // reset the main scroll\n        if(Math.abs(x)<app.touchThreshold){\n          $('main').scrollLeft(app.mainScroll);\n        }\n\n        app.mainScroll = null;\n        app.story.content.swipe(x, y, $(this).scrollTop());\n      });\n    },\n\n    swipe: function (x, y, top) {\n      if(!x || !y) return;\n      if(Math.abs(x) > Math.abs(y)){\n        if(x < 0){\n          // left swipe\n          if(x < -Math.abs(app.swipeThreshold)){\n            if(app.DEBUG) console.log('content swipe left');\n            app.story.previous();\n          }\n        }else{\n          // right swipe\n          if(x > Math.abs(app.swipeThreshold)){\n            if(app.DEBUG) console.log('content swipe right');\n            app.story.next();\n          }\n        }\n      }else{\n        if(y < 0){\n          // up swipe\n          if(y < -Math.abs(app.swipeThreshold)){\n            if(app.DEBUG) console.log('content swipe up');\n            if(top<2) app.story.cover.show(true);\n          }\n        }else{\n          // down swipe\n          if(y > Math.abs(app.swipeThreshold)){\n            if(app.DEBUG) console.log('content swipe down');\n          }\n        }\n      }\n    }\n  },\n\n\n\n\n  // Cover story Functions\n  cover: {\n    show: function (play) {\n      var story = app.story.getCurrent();\n      if(!$(story.cover).hasClass('over')) return;\n      if(!story.content){\n        $(story.cover).removeAttr('style').removeClass('over');\n      }else{\n        // stop any media playing in the content\n        app.story.content.stop(story);\n        // reset content scroll to zero\n        $(story.content).stop().animate({\n          scrollTop: 0\n        }, app.transitionSpeed);\n        // bring the cover down\n        $(story.cover).animate({\n          top: '0%'\n        }, app.transitionSpeed, function(){\n          $(this).removeClass('over').removeAttr('style');\n        });\n      }\n      console.log('show cover: ',play);\n      if(play===true) app.story.play(story);\n    },\n\n    eventListeners: function () {\n      $('.story-cover').on('touchstart', function(event){\n        if(!app.startedTF) return;\n        app.touchX = event.originalEvent.touches[0].clientX;\n        app.touchY = event.originalEvent.touches[0].clientY;\n        app.mainScroll = app.getScroll();\n      })\n      .on('touchmove', function(event){\n        if(!app.touchX || !app.touchY) return;\n        var x = app.touchX - event.originalEvent.touches[0].clientX;\n        var y = app.touchY - event.originalEvent.touches[0].clientY;\n        \n        if(Math.abs(x) > Math.abs(y)){\n          // scroll main as user moves from left to right\n          $('main').scrollLeft(app.getScroll() + x);\n        }else{\n          var story = app.story.getCurrent();\n          if(story.content && !$(story.cover).hasClass('over') && y>0){\n            y = (y/$('main').height()) * 100;\n            $(story.cover).css({'top': (y * -1)+'%'});\n          }\n        }\n        event.preventDefault();\n      })\n      .on('touchend', function(event){\n        if(!app.touchX && !app.touchY) return;\n        var x      = app.touchX - event.originalEvent.changedTouches[0].clientX;\n        var y      = app.touchY - event.originalEvent.changedTouches[0].clientY;\n        console.log(x, y, app.touchX, app.touchY, event.originalEvent.changedTouches[0].clientX, event.originalEvent.changedTouches[0].clientY);\n        app.touchX = null;\n        app.touchY = null;\n        //\n        if(Math.abs(x)<app.touchThreshold){\n          $('main').scrollLeft(app.mainScroll);\n        }\n        //\n        if(Math.abs(y)<app.touchThreshold){\n          var story = app.story.getCurrent();\n          $(story.cover).animate({\n            top: '0%'\n          }, app.transitionSpeed, function(){\n            $(this).removeAttr('style').removeClass('over');\n          });\n        }\n        app.mainScroll = null;\n        app.story.cover.swipe(x, y);\n      });\n    },\n\n    swipe: function (x, y) {\n      if(!x && !y) return;\n      console.log(x, y);\n      if(Math.abs(x) > Math.abs(y)){\n        if(x < 0){\n          // left swipe\n          if(x < -Math.abs(app.swipeThreshold)){\n            if(app.DEBUG) console.log('swipe left');\n            app.story.previous();\n          }\n        }else{\n          // right swipe\n          if(x > Math.abs(app.swipeThreshold)){\n            if(app.DEBUG) console.log('swipe right');\n            app.story.next();\n          }\n        }\n      }else{\n        if(y < 0){\n          // up swipe\n          if(y < -Math.abs(app.swipeThreshold)){\n            if(app.DEBUG) console.log('swipe up');\n          }\n        }else{\n          // down swipe\n          if(y > Math.abs(app.swipeThreshold)){\n            if(app.DEBUG) console.log('swipe down');\n            app.story.content.show();\n          }\n        }\n      }\n    }\n  }\n};\n","/*!\nSunil Patel, Developer, POV Digital | github.com/povdocs/pov-mobile-storytelling\nCopyright (C) 2016 POV | American Documentary Inc.\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n*/\n$(document).ready(function(){\n  app.init();\n});\n"],"sourceRoot":"/source/"}